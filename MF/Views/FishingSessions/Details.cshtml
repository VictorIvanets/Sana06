@model MF.Models.FishingSession

@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Details</h1>
<div class="row">
<div class="col-md-6">
    
    <h4>FishingSession</h4>
    <hr />
    <dl class="row">
        <dt class = "col-sm-4">
            @Html.DisplayNameFor(model => model.Name)
        </dt>
        <dd class = "col-sm-6">
            @Html.DisplayFor(model => model.Name)
        </dd>
        <dt class = "col-sm-4">
            @Html.DisplayNameFor(model => model.Description)
        </dt>
        <dd class = "col-sm-6">
            @Html.DisplayFor(model => model.Description)
        </dd>
        <dt class = "col-sm-4">
            @Html.DisplayNameFor(model => model.Date)
        </dt>
        <dd class = "col-sm-6">
            @Html.DisplayFor(model => model.Date)
        </dd>
        <dt class = "col-sm-4">
            @Html.DisplayNameFor(model => model.Rating)
        </dt>
        <dd class = "col-sm-6">
            @Html.DisplayFor(model => model.Rating)
        </dd>
        <dt class = "col-sm-4">
            @Html.DisplayNameFor(model => model.PlaceDb)
        </dt>
        <dd class = "col-sm-6">
            @Html.DisplayFor(model => model.PlaceDb.Name)
        </dd>
        <dt class = "col-sm-4">
            @Html.DisplayNameFor(model => model.ApplicationUser)
        </dt>
        <dd class = "col-sm-6">
            @Html.DisplayFor(model => model.ApplicationUser.FullName)
        </dd>

        <dt class="col-sm-4">
            Google Map Link
        </dt>
        <dd class="col-sm-8">
            <a class="whitelink" id="gstring" href="" target="_blank">Open</a>
        </dd>

    </dl>
    </div>
    <div class="col-md-6">
    <script src="~/lib/leaflet/leaflet.js"></script>
    <script src="~/lib/leaflet/leaflet.min.js"></script>
    <div id="map" style="width:100%;height:400px"></div>
    </div>
</div>

<div>
    <a asp-action="Edit" asp-route-id="@Model?.Id">Edit</a> |
    <a asp-action="Index">Back to List</a>
</div>


<script>

    var jsModel = @Html.Raw(Json.Serialize(Model));
    console.log(jsModel)
    console.log(jsModel.placeDb.coords.lat)
    console.log(jsModel.placeDb.coords.long)

    var stringGoogle = `https://www.google.com/maps?ll=${jsModel.placeDb.coords.lat},${jsModel.placeDb.coords.long}&q=${jsModel.placeDb.coords.lat},${jsModel.placeDb.coords.long}`

    document.getElementById("gstring").href = stringGoogle

    var map = L.map('map').setView([jsModel.placeDb.coords.lat, jsModel.placeDb.coords.long], 16);
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);


    L.marker([jsModel.placeDb.coords.lat, jsModel.placeDb.coords.long]).addTo(map)
        .bindPopup(`${jsModel.name}`)
        .openPopup;

    var popup = L.popup();


</script>
